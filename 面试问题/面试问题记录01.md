## 一： 自我介绍
- 老师您好， 我叫任善文， 毕业于山东理工大学(软件工程)专业。在国内TOP3的网络安全公司---奇安信科技股份有限公司， 有过一年多的Python服务端开发经验。
- 目前我掌握了很多技术： 
    - 版本管理 + 自动化集成部署：GIT  + CI/CD + Docker
    - 开发语言： Pyhton, Shell, 正在学习GO。
    - 后端框架: Django , Flask
    - 数据库： Mysql, PSQL, Reids, MongoDB都有过开发和使用经验。
    - 其他： AWS, GRPC, Numpy, M2Crypto, Crontab, Supervisor（进程监控工具）。 
- 目前在公司主要维护了四个项目
  - 证书系统， 包管理系统，公有云系统， 在线升级系统

## 二： 上家公司离职原因
- 技术发展受限
  - 维护的项目成熟 + 多。项目中使用的技术有些比较陈旧。
  - python2 + 前后端不分离。
  
## 三： 你还有什么需要问的吗？ 
- 咱们这个职位需要哪些技术？ 
- 入职XXX公司一直是我的梦想。


## 四： Mysql的底层原理
### 4.1: 解释一下Mysql的底层原理
- 局部性原理： 
  - innodb数据库，存储数据是按照页来存储的， 一页16K。我们在执行查询语句的时候，每次会在硬盘中取一整页的数据到内存中。然后在内存中再拿到我们想要的数据。
- Innodb索引，页的分类与结构
  - 分类： 索引页 + 数据页
  - 数据页：
    - 页头：前后指针
    - 页目录： 数据的二分索引
    - 数据域： 顺序结构存储的数据
- 索引中页与B+树的对应关系
  - 索引页对应B+树中的非叶子结点
  - 数据页对应B+树的叶子结点
  - 数据页页头的前后指针， 对应B+树结构中的叶子结点之间的双向指针。
  
### 4.1: B树和B+树的区别？
- B+树， 叶子结点， 存储data信息， 并且叶子结点包含了所有的值。B树每个结点都存储指针和值。
- B+树,  非叶子结点存储指针， 叶子结点不存储指针。叶子结点采用双向链表存储。

### 4.2: 采用B+树有什么优点和缺点？ 
- 缺点： 对于等值查询，和数据插入， 效率会慢一些。
- 优点： 方便范围查找。

## 五：使用过多线程和多进程吗？ 
### 5.1: 进程之间如何通信的？
	- 管道
	- 信号量
	- 信号
	- Sockte
	- 共享内存
	- 消息队列

## 六：了解数据库的连接池吗？ 
### 6.1: 一次请求， 就与mysql建立一次连接吗？ 
- 在没有连接池的情况下是的。

### 6.2: 连接池的工作原理
- 项目启动的时候， 初始化连接池。
- 当请求过来时，如果连接池中有空闲的连接， 则直接进行查询。查询完数据后， 再将连接对象放入连接池中。
- 当连接池中没有空闲连接时，如果没有超过限制的最大连接数，则生成新的连接对象，然后用新的连接对象查询，查询完成后， 将新的连接对象放入连接池中。
- 当超过最大连接数的时候， 返回稍后重试。

### 6.3: 为什么需要连接池？ 
- 限制连接的数量。
- 亲自证明过： Mysql超过300个连接， 就会出现连接无法执行的情况。
  - 案例： 开300个线程，去获取请求数据。发现只返回了280个左右的数据。

## 七： Redis主从
### 7.1: 说一下Redis主从是如何同步的？ 
- 1: 从库向主库发送psync命令， 表示进行数据同步。
- 2： 主库收到psync命令后，会用FULLRESYNC响应命令带上两个参数：主库runID和主库目前的复制进度offset，返回给从库
- 3： 主库执行bgsave命令，生成RDB文件，接着将文件发给从库
- 4： 从库接收到RDB文件后，会先清空当前数据库，然后加载RDB文件
- 5： 当主库完成RDB文件发送后，就会把此时replication buffer中的修改操作发给从库，从库再重新执行这些操作

### 7.2: 说一下哨兵机制？ 
- 哨兵作用： 
  - 监控， 选主， 通知
- 哨兵机制的流程
  - 哨兵进程在运行时，周期性地给所有的主从库发送PING命令，检测它们是否仍然在线运行。
  - 如果从库没有在规定时间内响应哨兵的PING命令，哨兵就会把它标记为“下线状态”；同样，如果主库也没有在规定时间内响应哨兵的PING命令，哨兵就会判定主库下线，然后开始自动切换主库的流程。
  - 主库挂了以后，哨兵就需要从很多个从库里，按照一定的规则选择一个从库实例，把它作为新的主库。
  - 哨兵会把新主库的连接信息发给其他从库，让它们执行replicaof命令，和新主库建立连接，并进行数据复制。同时，哨兵会把新主库的连接信息通知给客户端，让它们把请求操作发到新主库上。

### 7.3: 说一下哨兵选主算法？ 
- 打分规则
  - 用户可以通过slave-priority配置项，给不同的从库设置不同优先级。
  - 主从库同步时有个命令传播的过程。在这个过程中，主库会用master_repl_offset记录当前的最新写操作在repl_backlog_buffer中的位置，而从库会用slave_repl_offset这个值记录当前的复制进度。
  - 每个实例都会有一个ID，这个ID就类似于这里的从库的编号。


## 八：说一下Pyhton中的装饰器， 生成器， 迭代器
- 装饰器
	- 作用： 在不修改原函数及其调用方式的情况下对原函数功能进行扩展。
	- 装饰器装饰顺序： 从内到外， 调用顺序： 从外到内。
	- 经典写法： 
```python 
def check(fn):
    def inner():
        print("请先登录")
        fn()
    return inner
```

- 迭代器: 
	- 作用： 可以循环遍历迭代器内部元素
	- 实现： 一个类， 实现__iter__, 再实现__next__方法，这个类创建出来的对象都是可迭代对象
	- 拓展： for 循环的本质就是连续的执行next方法。

- 生成器： 
	- 作用： 降低内存占用
	- 特殊的迭代器： 一个函数， 使用到yield关键字， 则这个函数叫做生成器。
	- 本质： 调用next方法。


## 九： Python的内存管理机制： 
- 引用技术：
	- 变量引用一下， 引用计数就+1
	- del删除， 本质是引用计数-1 
- 垃圾回收： 
	- 标记清除：循环引用的
	- 分代回收
- 内存池： 

- 拓展： 解决内存泄漏的问题。

## 十： 说一下计算机网络中的5层协议和7层协议吧
- 应用层， 传输层， 网络层， 数据链路层， 物理层
- 应用层， 表示层， 会话层， 传输层， 网络层， 数据链路层， 物理层


### 十一： Cookie与Session的区别： 
> 1: 存储位置不同： cookie存储在浏览器，session存储在服务器。
> 2：存储大小不同，cookie存储受限，session由于存储在服务器端，因此不受限。
> 3：安全性不同：cookie不如session安全。


### 十二： Flask框架与Django框架？
### 12.1: Flask框架与Django框架的区别？ 
- Flask只有两个核心模块： 
  - Jinja2 : 支持前端模版渲染。
  - Werkzeug： 路由分发模块
- Django模块比较多： 
  - 自带ORM模块
  - 自带sqlite数据库
  - 自带开发测试用的服务器
  - 自带了admin后台管理
### 十三：Pyhton比较进阶的使用： 


